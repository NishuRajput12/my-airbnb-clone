<% layout("/layouts/boilerplate") %>

<body>
  <!-- Filters Section -->
  <div id="filters">
    <div class="filters-left">
      <div class="icon-btn" id="leftBtn">
        <i class="fa-solid fa-angle-left"></i>
      </div>

      <div class="filters-scroll" id="filtersScroll">
        <% 
        const iconMap = {
          trending: "fa-fire",
          room: "fa-bed",
          cities: "fa-city",
          mountain: "fa-mountain",
          castles: "fa-fort-awesome",
          domes: "fa-landmark-dome",
          camping: "fa-campground",
          beach: "fa-umbrella-beach",
          city: "fa-city",
          pets: "fa-paw",
          nature: "fa-tree",
          lakes: "fa-fish",
          snow: "fa-skiing"
        };
        filters.forEach(filter => { 
        %>
          <a href="/listings?category=<%= filter %>" 
             class="filter <%= activeCategory === filter ? 'active' : '' %>">
            <i class="fa-solid <%= iconMap[filter] %>"></i>
            <p><%= filter.charAt(0).toUpperCase() + filter.slice(1) %></p>
          </a>
        <% }) %>
      </div>

      <div class="icon-btn" id="rightBtn">
        <i class="fa-solid fa-angle-right"></i>
      </div>
    </div>
    <div class="filters-right">
      <div class="tax-filters">
        <i class="fa-solid fa-sliders"></i>
        <p>Filters</p>
      </div>

      <div class="tax-toggle">
        <div class="form-check-reverse form-switch">
          <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault">
          <label class="form-check-label">Display total before taxes</label>
        </div>
      </div>
    </div>
  </div>

  <!-- All Listings -->
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 mt-3">
    <% for(let listing of allListing) { %>
    <a href="/listings/<%= listing._id %>" class="listing-links">
      <div class="card col mb-4">
        <img
          src="<%=listing.image.url %>"
          class="card-img-top"
          alt="listing_image"
          style="height: 20rem"
        />
        <div class="card-img-overlay">
          <i class="fa-regular fa-heart"></i>
        </div>
        <div class="card-body">
          <h5 class="card-title"><b><%= listing.title %> </b></h5>
          <p class="card-price">
            &#8377;<%=listing.price.toLocaleString("en-IN") %> for 2 nights
            <i class="tax-info">&nbsp; &nbsp;+18% GST</i>
          </p>
        </div>
      </div>
    </a>
    <% } %>
  </div>

  <!-- All Listings Fallback -->
  <% if(allListing.length === 0){ %>
    <h5 class="text-center mt-5">No listings found for this filter.</h5>
  <% } %>

</body>
